// Copyright (c) 2019-2020 Calum Ewart Hutton
// Distributed under the GNU General Public License v3.0+, see the accompanying
// file LICENSE or https://opensource.org/licenses/GPL-3.0.

package lib.chutchut.cpmap.vector;

import java.util.HashSet;
import java.util.Set;

import lib.chutchut.cpmap.payload.base.Payload;

public class CPExploit {

    private CPVector vector;
    private Set<Payload> payloads = new HashSet<>();

    /*
     * Default constructor for Gson
     */
    private CPExploit() {}

    public CPExploit(CPVector vector, Set<Payload> payloads) {
        this.vector = vector.copy();
        this.payloads = payloads;
    }

    public CPExploit(CPVector vector, Payload payload) {
        this.vector = vector.copy();
        this.payloads.add(payload);
    }

    public CPVector getVector() {
        return vector;
    }

    public Set<Payload> getPayloads() {
        return payloads;
    }

    public Payload getPayload() {
        return payloads != null ? payloads.iterator().next() : null;
    }

    public void setVector(CPVector vector) {
        this.vector = vector.copy();
    }

    public CPVector getRenderedVector(Payload payload) {
        if (vector != null) {
            return vector.getWithPayload(payload);
        }
        return null;
    }
}
